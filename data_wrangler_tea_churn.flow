{"metadata": {"version": 1, "disable_limits": false, "instance_type": "ml.m5.4xlarge", "disable_validation": true}, "parameters": [], "nodes": [{"node_id": "03ca8112-a26c-4213-b476-76fef20671c4", "type": "SOURCE", "operator": "sagemaker.s3_source_0.1", "parameters": {"dataset_definition": {"datasetSourceType": "S3", "name": "tea_churn.csv", "description": null, "s3ExecutionContext": {"s3Uri": "s3://springboard-ml-churn-mini-project/raw/tea_churn.csv", "s3ContentType": "csv", "s3HasHeader": true, "s3FieldDelimiter": ",", "s3DirIncludesNested": false, "s3AddsFilenameColumn": false, "s3RoleArn": null, "s3CsvEncodingType": "UTF_8", "s3SkipLines": 0, "s3MultiLine": false, "s3DataType": "S3Prefix", "s3ManifestPlain": {"s3Uris": null}}, "canvasDatasetMetadata": null}}, "inputs": [], "outputs": [{"name": "default", "sampling": {"sampling_method": "sample_by_count", "sample_size": 50000}}]}, {"node_id": "b88a6908-b96a-4620-8165-6a0378cb5878", "type": "TRANSFORM", "operator": "sagemaker.spark.infer_and_cast_type_0.1", "parameters": {}, "trained_parameters": {"schema": {"custid": "string", "retained": "long", "created": "datetime", "firstorder": "datetime", "lastorder": "datetime", "esent": "long", "eopenrate": "float", "eclickrate": "float", "avgorder": "float", "ordfreq": "float", "paperless": "long", "refill": "long", "doorstep": "long", "favday": "string", "city": "string"}}, "inputs": [{"name": "default", "node_id": "03ca8112-a26c-4213-b476-76fef20671c4", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "31b93a43-049a-4a93-923c-5691242d7f33", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "12-13-2025_6:03:03_PM", "insights_report_parameters": {}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "b88a6908-b96a-4620-8165-6a0378cb5878", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "b1ed4b03-fc3b-4c4c-91ca-874ba7a26c91", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "12-13-2025_6:12:49_PM", "insights_report_parameters": {"target_column": "retained"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "b88a6908-b96a-4620-8165-6a0378cb5878", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "b041dc56-4d6a-4c12-884c-f8e599de825a", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "12-13-2025_6:40:10_PM", "insights_report_parameters": {"target_column": "esent", "problem_type": "Regression"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "4fed9495-5f9e-44dd-aac9-ed860923c477", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "bf4c4ccf-5930-4221-bbbf-a3c53a1ccb61", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "12-13-2025_6:44:43_PM", "insights_report_parameters": {"target_column": "retained", "problem_type": "Classification"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "4fed9495-5f9e-44dd-aac9-ed860923c477", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "0ec6dd8e-74e9-4d76-a4a9-2d4e17c8ec31", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "valid_dates", "formula": "if(isnull(created) or isnull(firstorder) or isnull(lastorder), \"N\", \"Y\")"}, "inputs": [{"name": "df", "node_id": "b88a6908-b96a-4620-8165-6a0378cb5878", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "007047c9-5b22-49ee-8505-172b9d2f23e7", "type": "TRANSFORM", "operator": "sagemaker.spark.filter_data_0.1", "parameters": {"filters": [{"column": "valid_dates", "condition": "=", "value": "Y"}]}, "inputs": [{"name": "df", "node_id": "0ec6dd8e-74e9-4d76-a4a9-2d4e17c8ec31", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "315e7a02-0303-4232-b112-b08e9225a347", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Drop column", "drop_column_parameters": {"column_to_drop": ["valid_dates"]}}, "inputs": [{"name": "df", "node_id": "007047c9-5b22-49ee-8505-172b9d2f23e7", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "0dead18f-b918-4de0-81e2-0200fcd3da58", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "12-13-2025_8:42:15_PM", "insights_report_parameters": {"problem_type": "Classification"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "315e7a02-0303-4232-b112-b08e9225a347", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "69b48929-f850-4054-89c0-a04c2e3e28c6", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "tenure_days", "formula": "datediff(lastorder, created)"}, "inputs": [{"name": "df", "node_id": "315e7a02-0303-4232-b112-b08e9225a347", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "be945bac-e197-4890-9b30-c1dd780b820e", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "time_to_first_order", "formula": "datediff(firstorder, created)"}, "inputs": [{"name": "df", "node_id": "69b48929-f850-4054-89c0-a04c2e3e28c6", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "f32fad50-d924-4144-b6e6-5ff0f45b0948", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "recency_days", "formula": "datediff(current_date(), lastorder)"}, "inputs": [{"name": "df", "node_id": "be945bac-e197-4890-9b30-c1dd780b820e", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "b11054fa-b93b-478b-b981-1e290d669889", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "purchase_intensity", "formula": "avgorder * ordfreq"}, "inputs": [{"name": "df", "node_id": "f32fad50-d924-4144-b6e6-5ff0f45b0948", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "895e0495-8f98-40a7-b40a-bcd50473950c", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "subscription_score", "formula": "paperless + refill + doorstep"}, "inputs": [{"name": "df", "node_id": "b11054fa-b93b-478b-b981-1e290d669889", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "687fbfc8-bed2-4791-9f30-52591530fe05", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "digital_customer", "formula": "if(subscription_score >= 2, 1, 0)"}, "inputs": [{"name": "df", "node_id": "895e0495-8f98-40a7-b40a-bcd50473950c", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "5d9f6d5d-085b-4d0c-b13c-535425071c04", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_formula_0.1", "parameters": {"output_column": "is_weekend", "formula": "if(favday == \"Saturday\" or favday == \"Sunday\", 1, 0)"}, "inputs": [{"name": "df", "node_id": "687fbfc8-bed2-4791-9f30-52591530fe05", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "18e75316-481b-4b0d-9178-b1754d3f9a43", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Drop column", "drop_column_parameters": {"column_to_drop": ["created", "firstorder"]}}, "inputs": [{"name": "df", "node_id": "5d9f6d5d-085b-4d0c-b13c-535425071c04", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "6245c77d-1625-4725-9255-25c0db1849dd", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "12-13-2025_9:06:04_PM", "insights_report_parameters": {"problem_type": "Classification"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "18e75316-481b-4b0d-9178-b1754d3f9a43", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "1dbc3554-08b4-40dd-80e8-8b3c2125315d", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "tenure_days", "original_data_type": "Object", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "18e75316-481b-4b0d-9178-b1754d3f9a43", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "5a2ad481-ad39-4860-a4fd-c8d46beb785c", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "time_to_first_order", "original_data_type": "Object", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "1dbc3554-08b4-40dd-80e8-8b3c2125315d", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "520d12b4-785b-4c6b-9f90-e6c8d49a0d91", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "recency_days", "original_data_type": "Object", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "5a2ad481-ad39-4860-a4fd-c8d46beb785c", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "3ea42f09-a07c-45a8-9d36-47f25d11eac4", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "digital_customer", "original_data_type": "Object", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "520d12b4-785b-4c6b-9f90-e6c8d49a0d91", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "baa260db-8b0e-47eb-a65d-48463730d192", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "is_weekend", "original_data_type": "Object", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "3ea42f09-a07c-45a8-9d36-47f25d11eac4", "output_name": "default"}], "outputs": [{"name": "default"}]}]}